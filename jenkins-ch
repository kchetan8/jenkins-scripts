pipeline {
    agent any
    options([parameters([string('git-repo-url')])])
 stages {
     stage('Git Checkout') {
        steps {
            git credentialsId: 'Githubpersonal8', url: 'params.git-repo-url' 
        }
    }
    stage('Maven Build') {
        steps {
            bat '''cd %git-repo-name%
            mvn clean install -DskipMunitTests'''
        }
    }
    stage('Cloudhub Deployment') {
        steps {

            withCredentials([usernamePassword(credentialsId: 'Anypoint14', passwordVariable: 'mule-password', usernameVariable: 'mule-username')]) {
    bat '''cd %git-repo-name%
    mvn package deploy -DmuleDeploy -DskipMunitTests -Dusername=%mule-username% -Dpassword=%mule-password% -Dapp.name=%app-name% -Dregion=%region% -Denvironment=%environment%'''
}
            
        }
    }
 }
}

